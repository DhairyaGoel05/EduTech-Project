<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/landing"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ isLogin ? 'Sign In' : 'Sign Up' }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="auth-content">
  <div class="auth-container">
    <div class="auth-header">
      <ion-icon name="school-outline" class="auth-logo"></ion-icon>
      <h1>EduLink</h1>
      <p>{{ isLogin ? 'Welcome back!' : 'Join our learning community' }}</p>
    </div>

    <div class="user-type-selector" *ngIf="!isLogin">
      <ion-segment [(ngModel)]="userType" (ionChange)="onUserTypeChange($event)">
        <ion-segment-button value="student">
          <ion-icon name="person-outline"></ion-icon>
          <ion-label>Student</ion-label>
        </ion-segment-button>
        <ion-segment-button value="teacher">
          <ion-icon name="people-outline"></ion-icon>
          <ion-label>Teacher</ion-label>
        </ion-segment-button>
      </ion-segment>
    </div>

    <form class="auth-form" (ngSubmit)="onSubmit()">
      <!-- Basic Info -->
      <ion-item>
        <ion-label position="stacked">Email</ion-label>
        <ion-input 
          type="email" 
          [(ngModel)]="formData.email" 
          name="email" 
          required>
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Password</ion-label>
        <ion-input 
          type="password" 
          [(ngModel)]="formData.password" 
          name="password" 
          required>
        </ion-input>
      </ion-item>

      <!-- Additional fields for signup -->
      <div *ngIf="!isLogin">
        <ion-item>
          <ion-label position="stacked">Full Name</ion-label>
          <ion-input 
            type="text" 
            [(ngModel)]="formData.fullName" 
            name="fullName" 
            required>
          </ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="stacked">Phone Number</ion-label>
          <ion-input 
            type="tel" 
            [(ngModel)]="formData.phone" 
            name="phone">
          </ion-input>
        </ion-item>

        <!-- Student specific fields -->
        <div *ngIf="userType === 'student'">
          <ion-item>
            <ion-label position="stacked">Grade/Class</ion-label>
            <ion-select [(ngModel)]="formData.grade" name="grade">
              <ion-select-option value="9">Grade 9</ion-select-option>
              <ion-select-option value="10">Grade 10</ion-select-option>
              <ion-select-option value="11">Grade 11</ion-select-option>
              <ion-select-option value="12">Grade 12</ion-select-option>
              <ion-select-option value="college">College</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">School/Institution</ion-label>
            <ion-input 
              type="text" 
              [(ngModel)]="formData.institution" 
              name="institution">
            </ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Subjects of Interest</ion-label>
            <ion-textarea 
              [(ngModel)]="formData.subjects" 
              name="subjects"
              placeholder="e.g., Mathematics, Physics, Chemistry">
            </ion-textarea>
          </ion-item>
        </div>

        <!-- Teacher specific fields -->
        <div *ngIf="userType === 'teacher'">
          <ion-item>
            <ion-label position="stacked">Teaching Experience (Years)</ion-label>
            <ion-input 
              type="number" 
              [(ngModel)]="formData.experience" 
              name="experience">
            </ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Subjects Teaching</ion-label>
            <ion-textarea 
              [(ngModel)]="formData.teachingSubjects" 
              name="teachingSubjects"
              placeholder="e.g., Mathematics, Physics, Chemistry">
            </ion-textarea>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Institution/School</ion-label>
            <ion-input 
              type="text" 
              [(ngModel)]="formData.institution" 
              name="institution">
            </ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Qualification</ion-label>
            <ion-input 
              type="text" 
              [(ngModel)]="formData.qualification" 
              name="qualification"
              placeholder="e.g., M.Ed, B.Ed, PhD">
            </ion-input>
          </ion-item>
        </div>
      </div>

      <ion-button 
        expand="block" 
        type="submit" 
        class="auth-button"
        [disabled]="isLoading">
        <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
        {{ isLogin ? 'Sign In' : 'Create Account' }}
      </ion-button>
    </form>

    <div class="auth-footer">
      <p>
        {{ isLogin ? "Don't have an account?" : "Already have an account?" }}
        <ion-button fill="clear" (click)="toggleAuthMode()">
          {{ isLogin ? 'Sign Up' : 'Sign In' }}
        </ion-button>
      </p>
    </div>
  </div>
</ion-content>