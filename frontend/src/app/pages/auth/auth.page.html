<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ isLogin ? 'Log In' : 'Sign Up' }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="auth-content">
  <div class="auth-container">
    <div class="auth-header">
      <ion-icon name="school-outline" class="auth-logo"></ion-icon>
      <h1>{{ isLogin ? 'Welcome Back!' : 'Join our learning community' }}</h1>
      <p>{{ isLogin ? 'Log in to continue your journey' : 'Create an account to get started' }}</p>
    </div>

    <!-- User Type Selector (only for signup) -->
    <div class="user-type-selector" *ngIf="!isLogin">
      <ion-segment (ionChange)="onUserTypeChange($event)" [value]="userType">
        <ion-segment-button value="student">
          <ion-icon name="person-circle-outline"></ion-icon>
          <ion-label>Student</ion-label>
        </ion-segment-button>
        <ion-segment-button value="teacher">
          <ion-icon name="people-circle-outline"></ion-icon>
          <ion-label>Teacher</ion-label>
        </ion-segment-button>
      </ion-segment>
    </div>

    <!-- Main Authentication Form -->
    <div class="auth-form">
      <form #form="ngForm" (ngSubmit)="onSubmit()">
        <!-- Common Fields -->
        <ion-item>
          <ion-label position="floating">Email</ion-label>
          <ion-input type="email" [(ngModel)]="formData.email" name="email" required autocomplete="off"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Password</ion-label>
          <ion-input type="password" [(ngModel)]="formData.password" name="password" required autocomplete="off"></ion-input>
        </ion-item>

        <!-- Signup Fields -->
        <div *ngIf="!isLogin">
          <ion-item>
            <ion-label position="floating">Full Name</ion-label>
            <ion-input type="text" [(ngModel)]="formData.fullName" name="fullName" required autocomplete="off"></ion-input>
          </ion-item>
          
          <ion-item>
            <ion-label position="floating">Phone Number</ion-label>
            <ion-input type="tel" [(ngModel)]="formData.phone" name="phone" required autocomplete="off"></ion-input>
          </ion-item>
          
          <ion-item>
            <ion-label position="floating">School/Institution</ion-label>
            <ion-input type="text" [(ngModel)]="formData.institution" name="institution" required autocomplete="off"></ion-input>
          </ion-item>

          <!-- Student Specific Fields -->
          <div *ngIf="userType === 'student'">
            <ion-item>
              <ion-label position="floating">Grade/Class</ion-label>
              <ion-input type="text" [(ngModel)]="formData.grade" name="grade" autocomplete="off"></ion-input>
            </ion-item>
            <ion-item>
              <ion-label position="floating">Subjects of Interest</ion-label>
              <ion-input type="text" [(ngModel)]="formData.subjects" name="subjects" autocomplete="off"></ion-input>
            </ion-item>
          </div>

          <!-- Teacher Specific Fields -->
          <div *ngIf="userType === 'teacher'">
            <ion-item>
              <ion-label position="floating">Qualification</ion-label>
              <ion-input type="text" [(ngModel)]="formData.qualification" name="qualification" autocomplete="off"></ion-input>
            </ion-item>
            <ion-item>
              <ion-label position="floating">Years of Experience</ion-label>
              <ion-input type="number" [(ngModel)]="formData.experience" name="experience" autocomplete="off"></ion-input>
            </ion-item>
            <ion-item>
              <ion-label position="floating">Subjects Taught</ion-label>
              <ion-input type="text" [(ngModel)]="formData.teachingSubjects" name="teachingSubjects" autocomplete="off"></ion-input>
            </ion-item>
          </div>
        </div>
        
        <ion-button class="auth-button" type="submit" expand="block" [disabled]="form.invalid || isLoading">
          <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
          <span *ngIf="!isLoading">{{ isLogin ? 'Log In' : 'Create Account' }}</span>
        </ion-button>
      </form>
    </div>

    <div class="auth-footer">
      <p>{{ isLogin ? 'Don\'t have an account?' : 'Already have an account?' }}</p>
      <ion-button fill="clear" (click)="toggleAuthMode()">
        {{ isLogin ? 'Sign Up' : 'Log In' }}
      </ion-button>
    </div>
  </div>
</ion-content>
